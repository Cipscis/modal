{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://modal/./node_modules/keybinding/KeyBind.js","webpack://modal/./node_modules/keybinding/KeyPress.js","webpack://modal/./node_modules/keybinding/keybinding.js","webpack://modal/./focus-helpers.js","webpack://modal/./trap-focus.js","webpack://modal/./modal.js","webpack://modal/./docs/assets/js/src/main.js"],"sourcesContent":["class KeyBind extends Array {\r\n\tconstructor(bindingString) {\r\n\t\tif (!(typeof bindingString === 'string')) {\r\n\t\t\tthrow new RangeError(`KeyBind: Constructor argument must be a string`);\r\n\t\t}\r\n\r\n\t\tsuper(0);\r\n\r\n\t\tconst bindings = bindingString.trim().split(/\\s+/g);\r\n\r\n\t\tfor (const binding of bindings) {\r\n\t\t\tthis.push(binding);\r\n\t\t}\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn this.join(' ');\r\n\t}\r\n\r\n\tmatch(keyPresses) {\r\n\t\tif (keyPresses.length !== this.length) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tfor (const [i, keyPress] of keyPresses.entries()) {\r\n\t\t\tconst keyBind = this[i];\r\n\r\n\t\t\tif (!keyPress.match(keyBind)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport { KeyBind };\r\n","const Patterns = Object.freeze({\r\n\talt: /\\balt\\+/g,\r\n\tctrl: /\\b(control|ctrl|command|cmd|meta)\\+/g,\r\n\tshift: /\\bshift\\+/g,\r\n});\r\n\r\nconst Aliases = Object.freeze({\r\n\t'space': ' ',\r\n\t'spacebar': ' ',\r\n\r\n\t'up': 'arrowup',\r\n\t'right': 'arrowright',\r\n\t'down': 'arrowdown',\r\n\t'left': 'arrowleft',\r\n\r\n\t'esc': 'escape',\r\n});\r\n\r\nclass KeyPress {\r\n\tconstructor(options) {\r\n\t\tif (!('key' in options)) {\r\n\t\t\tthrow new RangeError(`KeyPress: key is a required option`);\r\n\t\t}\r\n\t\tthis.key = options.key;\r\n\t\tthis.modifiers = {\r\n\t\t\taltKey: options.altKey || false,\r\n\t\t\tctrlKey: options.metaKey || options.ctrlKey || false,\r\n\t\t\tshiftKey: options.shiftKey || false,\r\n\t\t};\r\n\t}\r\n\r\n\tmatch(keyString) {\r\n\t\tconst requiredModifiers = {\r\n\t\t\taltKey: false,\r\n\t\t\tctrlKey: false,\r\n\t\t\tshiftKey: false,\r\n\t\t};\r\n\r\n\t\t// Gather required modifiers for keyString\r\n\t\tif (Patterns.alt.test(keyString)) {\r\n\t\t\trequiredModifiers.altKey = true;\r\n\t\t\tkeyString = keyString.replace(Patterns.alt, '');\r\n\t\t}\r\n\r\n\t\tif (Patterns.ctrl.test(keyString)) {\r\n\t\t\trequiredModifiers.ctrlKey = true;\r\n\t\t\tkeyString = keyString.replace(Patterns.ctrl, '');\r\n\t\t}\r\n\r\n\t\tif (Patterns.shift.test(keyString)) {\r\n\t\t\trequiredModifiers.shiftKey = true;\r\n\t\t\tkeyString = keyString.replace(Patterns.shift, '');\r\n\t\t}\r\n\r\n\t\t// Check if all keyString's required modifiers were met\r\n\t\tfor (const modifier in requiredModifiers) {\r\n\t\t\tif (requiredModifiers[modifier] && !this.modifiers[modifier]) {\r\n\t\t\t\t// The modifier was required but not recorded\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Check if they keyString's key matches the key pressed\r\n\t\tif (keyString.toLowerCase() === this.key.toLowerCase()) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Check if the keyString is an alias for a matching key\r\n\t\tif (Aliases[keyString.toLowerCase()] === this.key.toLowerCase()) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport { KeyPress };\r\n","import { KeyBind } from './KeyBind.js';\nimport { KeyPress } from './KeyPress.js';\n\nconst bindings = new Map();\n/**\n<Map>{\n\t[keyString]: <Map>{\n\t\t[fn]: fnWrapper,\n\t},\n};\n*/\n\nconst defaults = Object.freeze({\n\tallowInInput: false,\n});\n\nconst createFnWrapper = (keyString, fn, opts) => {\n\tconst options = Object.assign({}, defaults, opts);\n\n\tconst keyBind = new KeyBind(keyString);\n\tconst keyLog = [];\n\n\treturn function (e) {\n\t\t// Ignore modifier keys\n\t\tif (['Alt', 'Control', 'Meta', 'Shift'].includes(e.key)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Don't check key if focus is in a prohibited place\n\t\tif ((!options.allowInInput) && isInput(document.activeElement)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isProtected(document.activeElement)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst keyPress = new KeyPress(e);\n\t\tkeyLog.push(keyPress);\n\n\t\tif (keyLog.length > keyBind.length) {\n\t\t\tkeyLog.shift();\n\t\t}\n\n\t\tif (keyBind.match(keyLog)) {\n\t\t\t// Clear keyLog and call function\n\n\t\t\tkeyLog.splice(0);\n\t\t\tfn.apply(this, arguments);\n\t\t}\n\t};\n};\n\nconst bind = (keyString, fn, options) => {\n\tif (!bindings.has(keyString)) {\n\t\tbindings.set(keyString, new Map());\n\t}\n\n\tconst keyStringBindings = bindings.get(keyString);\n\n\tif (keyStringBindings.has(fn)) {\n\t\t// Do nothing - this binding already exists\n\t\treturn;\n\t}\n\n\tconst fnWrapper = createFnWrapper(keyString, fn, options);\n\n\tdocument.addEventListener('keydown', fnWrapper);\n\tkeyStringBindings.set(fn, fnWrapper);\n};\n\nconst unbind = (keyString, fn) => {\n\tconst keyStringBindings = bindings.get(keyString);\n\n\tif (!keyStringBindings) {\n\t\treturn;\n\t}\n\n\tconst fnWrapper = keyStringBindings.get(fn);\n\n\tdocument.removeEventListener('keydown', fnWrapper);\n\tkeyStringBindings.delete(fn);\n};\n\nconst isInput = function ($element) {\n\tconst nodeName = $element.nodeName.toLowerCase();\n\n\tlet isInput = false;\n\n\tif (['textarea', 'select'].includes(nodeName)) {\n\t\tisInput = true;\n\t} else if (nodeName === 'input') {\n\t\tisInput = true;\n\n\t\tconst inputType = ($element.attributes.type?.value || 'text').toLowerCase();\n\n\t\tif (['button', 'checkbox', 'color', 'file', 'hidden', 'image', 'radio', 'range', 'reset', 'submit'].includes(inputType)) {\n\t\t\tisInput = false;\n\t\t}\n\t} else if ($element.isContentEditable) {\n\t\tisInput = true;\n\t}\n\n\treturn isInput;\n};\n\nconst isProtected = function ($element) {\n\tconst nodeName = $element.nodeName.toLowerCase();\n\n\tlet isProtected = false;\n\n\tif (nodeName === 'input') {\n\t\tconst inputType = ($element.attributes.type?.value || 'text').toLowerCase();\n\n\t\tif (inputType === 'password') {\n\t\t\tisProtected = true;\n\t\t}\n\t}\n\n\treturn isProtected;\n};\n\nexport {\n\tbind,\n\tunbind,\n};\n","const visible = function ($el) {\r\n\t// Check visibility in terms of if an element may be focusable\r\n\r\n\tlet isVisible = true;\r\n\r\n\tconst style = window.getComputedStyle($el);\r\n\r\n\tif (\r\n\t\t(style.position !== 'fixed') &&\r\n\t\t((['body', 'html']).includes($el.tagName.toLowerCase())) === false\r\n\t) {\r\n\t\t// For elements that aren't fixed position, <body>, or <html>,\r\n\t\t// their offsetParent will be null if they or an ancestor is display: none;\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetParent\r\n\t\tif ($el.offsetParent === null) {\r\n\t\t\tisVisible = false;\r\n\t\t}\r\n\t} else {\r\n\t\tconst visibility = style.visibility;\r\n\t\tconst display = style.display;\r\n\r\n\t\tif (display === 'none') {\r\n\t\t\tisVisible = false;\r\n\t\t} else if (visibility === 'hidden') {\r\n\t\t\tisVisible = false;\r\n\t\t} else {\r\n\t\t\t// Check if an element is hidden because of an ancestor's style\r\n\t\t\tfor (const $ancestor = $el.ancestorElement; !!$ancestor; $ancestor = $el.ancestorElement) {\r\n\t\t\t\tconst ancestorStyle = window.getComputedStyle($el);\r\n\r\n\t\t\t\t// If a ancestor is display: none, this element is hidden\r\n\t\t\t\tif (ancestorStyle.display === 'none') {\r\n\t\t\t\t\tisVisible = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn isVisible;\r\n};\r\n\r\nconst focusable = function ($el) {\r\n\tlet isFocusable;\r\n\r\n\tif ($el.matches('input, select, textarea, button, object')) {\r\n\t\t// Focus if not disabled\r\n\t\tconst isNotDisabled = $el.disabled === false;\r\n\r\n\t\tisFocusable = isNotDisabled;\r\n\t} else if ($el.matches('a, area')) {\r\n\t\t// Focus through href attribute\r\n\t\tconst hasHrefAttribute = $el.matches('[href]');\r\n\r\n\t\tisFocusable = hasHrefAttribute;\r\n\t} else if ($el.matches('[tabindex]')) {\r\n\t\t// Focus through tabindex attribute\r\n\t\tisFocusable = true;\r\n\t} else if ($el.matches('[contentEditable=\"true\"]')) {\r\n\t\t// Focus through contentEditable\r\n\t\tisFocusable = true;\r\n\t}\r\n\r\n\tif (isFocusable) {\r\n\t\tconst isVisible = visible($el);\r\n\r\n\t\tisFocusable = isVisible;\r\n\t}\r\n\r\n\treturn isFocusable;\r\n};\r\n\r\nconst tabbable = function ($el) {\r\n\tlet isTabbable = false;\r\n\r\n\tconst isFocusable = focusable($el);\r\n\tif (isFocusable) {\r\n\t\t// Can receive focus, therefore tababble unless tabindex=\"-1\"\r\n\t\tconst untabbableTabIndex = $el.matches('[tabindex=\"-1\"]');\r\n\r\n\t\tisTabbable = !untabbableTabIndex;\r\n\t}\r\n\r\n\treturn isTabbable;\r\n};\r\n\r\nexport {\r\n\tvisible,\r\n\tfocusable,\r\n\ttabbable,\r\n};\r\n","import { visible, focusable, tabbable } from './focus-helpers.js';\r\n\r\nconst classes = Object.freeze({\r\n\ttrap: 'js-focus-trap',\r\n});\r\n\r\nconst selectors = Object.freeze({\r\n\ttrap: `.${classes.trap}`,\r\n});\r\n\r\n// There can only be one\r\nlet $trap;\r\n\r\n/*\r\nAdding these dummy elements is necessary in case the focus trap\r\nis the first or last tabbable area on the page, in which case\r\nthe user moving focus may move it out of the DOM and therefore\r\nwon't be picked up by 'focus' events\r\n*/\r\nconst $dummyStart = document.createElement('div');\r\n$dummyStart.setAttribute('tabindex', 0);\r\n// <div tabindex=\"0\"></div>\r\n\r\nconst $dummyEnd = document.createElement('div');\r\n$dummyEnd.setAttribute('tabindex', 0);\r\n// <div tabindex=\"0\"></div>\r\n\r\nconst trapFocus = function ($el) {\r\n\t// Remove any existing focus traps\r\n\tif ($trap) {\r\n\t\tuntrapFocus();\r\n\t}\r\n\r\n\t// Record current focus trap\r\n\t$trap = $el;\r\n\t$trap.classList.add(classes.trap);\r\n\r\n\t// Add dummy elements for detecting last tab\r\n\t$trap.parentNode.insertBefore($dummyStart, $trap);\r\n\t$trap.parentNode.insertBefore($dummyEnd, $trap.nextSibling);\r\n\r\n\tdocument.querySelectorAll('*').forEach((el) => el.addEventListener('focus', wrapTab));\r\n};\r\n\r\nconst untrapFocus = function () {\r\n\tdocument.querySelectorAll('*').forEach((el) => el.removeEventListener('focus', wrapTab));\r\n\r\n\t$trap.classList.remove(classes.trap);\r\n\t$trap = null;\r\n\r\n\t$dummyStart.remove();\r\n\t$dummyEnd.remove();\r\n};\r\n\r\nconst wrapTab = function (e) {\r\n\tconst $focus = e.target;\r\n\r\n\tconst isInTrap = !!$focus.closest(selectors.trap);\r\n\r\n\tif (!isInTrap) {\r\n\t\tconst $descendants = $trap.querySelectorAll('*');\r\n\t\tconst $tabbable = Array.prototype.filter.call($descendants, tabbable);\r\n\r\n\t\tconst afterTrap = $trap.compareDocumentPosition($focus) === Node.DOCUMENT_POSITION_FOLLOWING;\r\n\r\n\t\tif (afterTrap) {\r\n\t\t\t// Wrap to start\r\n\t\t\t$tabbable[0].focus();\r\n\t\t} else {\r\n\t\t\t// Wrap to end\r\n\t\t\t$tabbable[$tabbable.length-1].focus();\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport {\r\n\ttrapFocus,\r\n\tuntrapFocus,\r\n};\r\n","import * as keys from 'keybinding';\nimport { trapFocus, untrapFocus } from './trap-focus.js';\nimport { focusable } from './focus-helpers.js';\n\nconst selectors = {\n\tmodal: '.js-modal',\n\tbody: '.js-modal__body',\n\ttrigger: '.js-modal__trigger',\n\tclose: '.js-modal__close',\n};\n\nconst dataAttributes = Object.freeze({\n\tbodyOpenClass: 'data-modal-body-open-class',\n});\n\nconst classes = Object.freeze({\n\tbodyOpen: 'modal__body-open',\n});\n\nlet $focus; // The active modal window\nlet $active; // The element that had focus before opening the modal window\n\nconst module = {\n\tinit: function (options) {\n\t\toptions = options ?? {};\n\n\t\tif (options.onShow) {\n\t\t\tmodule._onShow = options.onShow;\n\t\t}\n\t\tif (options.onHide) {\n\t\t\tmodule._onHide = options.onHide;\n\t\t}\n\t\tif (options.triggerSelector) {\n\t\t\tselectors.trigger = options.triggerSelector;\n\t\t}\n\n\t\tmodule._initEvents();\n\t},\n\n\t_initEvents: function () {\n\t\tdocument.addEventListener('click', module._processTriggerClickEvent);\n\t},\n\n\t_bindModalActiveEvents: function () {\n\t\tkeys.bind('esc', module._hide, { allowInInput: true });\n\n\t\tdocument.addEventListener('click', module._hideEvent);\n\t\tdocument.addEventListener('click', module._hideIfBackgroundClickEvent);\n\n\t\ttrapFocus($active.querySelector(selectors.body));\n\t},\n\n\t_unbindModalActiveEvents: function () {\n\t\tkeys.unbind('esc', module._hide);\n\n\t\tdocument.removeEventListener('click', module._hideEvent);\n\t\tdocument.removeEventListener('click', module._hideIfBackgroundClickEvent);\n\n\t\tuntrapFocus();\n\t},\n\n\t// Event callbacks\n\t_processTriggerClickEvent: function (e) {\n\t\tconst $trigger = e.target.closest(selectors.trigger);\n\t\tif ($trigger) {\n\t\t\te.preventDefault();\n\n\t\t\tconst targetId = module._getTargetId($trigger);\n\n\t\t\tmodule._showById(targetId);\n\t\t}\n\t},\n\n\t_getTargetId: function ($trigger) {\n\t\tlet targetId = $trigger.getAttribute('href');\n\n\t\tif (/^#/.test(targetId) === true) {\n\t\t\ttargetId = targetId.substring(1);\n\t\t} else {\n\t\t\ttargetId = $trigger.getAttribute('aria-controls');\n\t\t}\n\n\t\treturn targetId;\n\t},\n\n\t_hideIfBackgroundClickEvent: function (e) {\n\t\tconst $this = e.target;\n\n\t\tif ($this.closest(selectors.body)) {\n\t\t\t// Click was within the modal popup, so ignore it\n\t\t\treturn;\n\t\t} else if ($this.closest(selectors.trigger)) {\n\t\t\t// Click was within the trigger, so ignore it\n\t\t\treturn;\n\t\t} else {\n\t\t\t// Click was outside the modal popup, so close it\n\t\t\tmodule._hide();\n\t\t}\n\t},\n\n\t// Hide/Show functions\n\t_showById: function (id) {\n\t\tconst $modal = document.getElementById(id);\n\n\t\tif ($modal) {\n\t\t\tmodule._show($modal);\n\t\t}\n\t},\n\n\t_show: function ($modal) {\n\t\tif ($modal === $active) {\n\t\t\t// Do nothing if the modal is already open\n\t\t\treturn;\n\t\t}\n\n\t\tif ($active) {\n\t\t\t// If there's already an active modal window,\n\t\t\t// keep remembering the same $focus element\n\t\t\tmodule._hide();\n\t\t}\n\n\t\t$focus = document.activeElement;\n\t\t$active = $modal;\n\n\t\t$modal.setAttribute('aria-hidden', false);\n\n\t\tconst bodyOpenClass = module._getBodyOpenClass($modal);\n\t\tdocument.querySelector('body').classList.add(bodyOpenClass);\n\n\t\t// Move focus within modal window\n\t\tconst $focusable = module._getFocusable();\n\t\tif ($focusable.length) {\n\t\t\t$focusable[0].focus();\n\t\t}\n\n\t\tmodule._bindModalActiveEvents();\n\n\t\tif (module._onShow) {\n\t\t\tmodule._onShow($modal);\n\t\t}\n\t},\n\n\t_hideEvent: function (e) {\n\t\tconst $target = e.target;\n\t\tif ($target.closest(selectors.close)) {\n\t\t\te.preventDefault();\n\t\t\tmodule._hide();\n\t\t}\n\t},\n\n\t_hide: function () {\n\t\tif ($active) {\n\t\t\tconst $modal = $active;\n\t\t\t$modal.setAttribute('aria-hidden', true);\n\n\t\t\tconst bodyOpenClass = module._getBodyOpenClass($modal);\n\t\t\tdocument.querySelector('body').classList.remove(bodyOpenClass);\n\n\t\t\tmodule._unbindModalActiveEvents();\n\n\t\t\t// Return focus where it was\n\t\t\tif ($focus) {\n\t\t\t\t$focus.focus();\n\t\t\t}\n\n\t\t\t$active = null;\n\t\t\t$focus = null;\n\n\t\t\tif (module._onHide) {\n\t\t\t\tmodule._onHide($modal);\n\t\t\t}\n\t\t}\n\t},\n\n\t_getBodyOpenClass: function ($modal) {\n\t\tconst bodyOpenClass = $modal.getAttribute(dataAttributes.bodyOpenClass) || classes.bodyOpen;\n\n\t\treturn bodyOpenClass;\n\t},\n\n\t// Focus management\n\t_getFocusable: function ($modal) {\n\t\t$modal = $modal || $active;\n\t\tconst $body = $modal.querySelector(selectors.body);\n\n\t\tconst $descendents = $body.querySelectorAll('*');\n\t\tconst $focusable = Array.prototype.filter.call($descendents, focusable);\n\n\t\tif (focusable($body)) {\n\t\t\t$focusable.unshift($body);\n\t\t}\n\n\t\treturn $focusable;\n\t},\n\n\t// Exports\n\tshow: function (id) {\n\t\treturn module._showById(id);\n\t},\n\n\thide: function () {\n\t\treturn module._hide();\n\t},\n};\n\nexport const {\n\tinit,\n\tshow,\n\thide,\n} = module;\n","// Using import from '/filename', Webpack will\n// bundle files from outside the docs directory\n// even though it is the root for the server\n// both locally and on GitHub Pages\n\nimport * as modal from '/modal.js';\nimport * as keys from 'keybinding';\n\nmodal.init({\n\tonShow: ($modal) => console.log('Show', $modal),\n\tonHide: ($modal) => console.log('Hide', $modal),\n});\n\nconst selectors = Object.freeze({\n\tshow: '.js-example__show',\n\thide: '.js-example__hide',\n});\n\nconst showExample = (e) => {\n\te.stopPropagation();\n\n\tmodal.show('modal-show-example');\n};\ndocument.querySelectorAll(selectors.show).forEach(($el) => $el.addEventListener('click', showExample));\nkeys.bind('B', showExample);\n\ndocument.querySelectorAll(selectors.hide).forEach(($el) => $el.addEventListener('click', modal.hide));\n"],"names":["KeyBind","Array","constructor","bindingString","RangeError","super","bindings","trim","split","binding","this","push","toString","join","match","keyPresses","length","i","keyPress","entries","keyBind","Patterns","Object","freeze","alt","ctrl","shift","Aliases","KeyPress","options","key","modifiers","altKey","ctrlKey","metaKey","shiftKey","keyString","requiredModifiers","test","replace","modifier","toLowerCase","Map","defaults","allowInInput","createFnWrapper","fn","opts","assign","keyLog","e","includes","isInput","document","activeElement","isProtected","splice","apply","arguments","bind","has","set","keyStringBindings","get","fnWrapper","addEventListener","$element","nodeName","inputType","attributes","type","value","isContentEditable","focusable","$el","isFocusable","matches","disabled","isVisible","style","window","getComputedStyle","position","tagName","offsetParent","visibility","display","$ancestor","ancestorElement","visible","tabbable","isTabbable","classes","trap","selectors","$trap","$dummyStart","createElement","setAttribute","$dummyEnd","untrapFocus","querySelectorAll","forEach","el","removeEventListener","wrapTab","classList","remove","$focus","target","closest","$descendants","$tabbable","prototype","filter","call","compareDocumentPosition","Node","DOCUMENT_POSITION_FOLLOWING","focus","modal","body","trigger","close","dataAttributes","bodyOpenClass","bodyOpen","$active","init","onShow","_onShow","onHide","_onHide","triggerSelector","_initEvents","_processTriggerClickEvent","_bindModalActiveEvents","_hide","_hideEvent","_hideIfBackgroundClickEvent","querySelector","add","parentNode","insertBefore","nextSibling","_unbindModalActiveEvents","delete","$trigger","preventDefault","targetId","_getTargetId","_showById","getAttribute","substring","$this","id","$modal","getElementById","_show","_getBodyOpenClass","$focusable","_getFocusable","$body","$descendents","unshift","show","hide","console","log","showExample","stopPropagation"],"sourceRoot":""}